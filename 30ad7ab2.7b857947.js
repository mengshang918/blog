(window.webpackJsonp=window.webpackJsonp||[]).push([[44],{249:function(e,a,t){"use strict";t.d(a,"a",(function(){return m})),t.d(a,"b",(function(){return s}));var n=t(0),r=t.n(n);function b(e,a,t){return a in e?Object.defineProperty(e,a,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[a]=t,e}function p(e,a){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);a&&(n=n.filter((function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable}))),t.push.apply(t,n)}return t}function c(e){for(var a=1;a<arguments.length;a++){var t=null!=arguments[a]?arguments[a]:{};a%2?p(Object(t),!0).forEach((function(a){b(e,a,t[a])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):p(Object(t)).forEach((function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(t,a))}))}return e}function o(e,a){if(null==e)return{};var t,n,r=function(e,a){if(null==e)return{};var t,n,r={},b=Object.keys(e);for(n=0;n<b.length;n++)t=b[n],a.indexOf(t)>=0||(r[t]=e[t]);return r}(e,a);if(Object.getOwnPropertySymbols){var b=Object.getOwnPropertySymbols(e);for(n=0;n<b.length;n++)t=b[n],a.indexOf(t)>=0||Object.prototype.propertyIsEnumerable.call(e,t)&&(r[t]=e[t])}return r}var l=r.a.createContext({}),i=function(e){var a=r.a.useContext(l),t=a;return e&&(t="function"==typeof e?e(a):c(c({},a),e)),t},m=function(e){var a=i(e.components);return r.a.createElement(l.Provider,{value:a},e.children)},j={inlineCode:"code",wrapper:function(e){var a=e.children;return r.a.createElement(r.a.Fragment,{},a)}},O=r.a.forwardRef((function(e,a){var t=e.components,n=e.mdxType,b=e.originalType,p=e.parentName,l=o(e,["components","mdxType","originalType","parentName"]),m=i(t),O=n,s=m["".concat(p,".").concat(O)]||m[O]||j[O]||b;return t?r.a.createElement(s,c(c({ref:a},l),{},{components:t})):r.a.createElement(s,c({ref:a},l))}));function s(e,a){var t=arguments,n=a&&a.mdxType;if("string"==typeof e||n){var b=t.length,p=new Array(b);p[0]=O;var c={};for(var o in a)hasOwnProperty.call(a,o)&&(c[o]=a[o]);c.originalType=e,c.mdxType="string"==typeof e?e:n,p[1]=c;for(var l=2;l<b;l++)p[l]=t[l];return r.a.createElement.apply(null,p)}return r.a.createElement.apply(null,t)}O.displayName="MDXCreateElement"},250:function(e,a,t){"use strict";var n=t(0),r=t(22);a.a=function(){var e=Object(n.useContext)(r.a);if(null===e)throw new Error("Docusaurus context not provided");return e}},251:function(e,a,t){"use strict";t.d(a,"b",(function(){return b})),t.d(a,"a",(function(){return p}));var n=t(250),r=t(252);function b(){var e=Object(n.a)().siteConfig,a=(e=void 0===e?{}:e).baseUrl,t=void 0===a?"/":a,b=e.url;return{withBaseUrl:function(e,a){return function(e,a,t,n){var b=void 0===n?{}:n,p=b.forcePrependBaseUrl,c=void 0!==p&&p,o=b.absolute,l=void 0!==o&&o;if(!t)return t;if(t.startsWith("#"))return t;if(Object(r.b)(t))return t;if(c)return a+t;var i=t.startsWith(a)?t:a+t.replace(/^\//,"");return l?e+i:i}(b,t,e,a)}}}function p(e,a){return void 0===a&&(a={}),(0,b().withBaseUrl)(e,a)}},252:function(e,a,t){"use strict";function n(e){return!0===/^(\w*:|\/\/)/.test(e)}function r(e){return void 0!==e&&!n(e)}t.d(a,"b",(function(){return n})),t.d(a,"a",(function(){return r}))},70:function(e,a,t){"use strict";t.r(a),t.d(a,"frontMatter",(function(){return c})),t.d(a,"metadata",(function(){return o})),t.d(a,"rightToc",(function(){return l})),t.d(a,"default",(function(){return m}));var n=t(2),r=t(7),b=(t(0),t(249)),p=t(251),c={id:"e0189ac820aefcacbde63dfb11654d49",title:"monorepo"},o={unversionedId:"\u5de5\u7a0b\u5316/\u4f9d\u8d56\u7ba1\u7406/monorepo/e0189ac820aefcacbde63dfb11654d49",id:"\u5de5\u7a0b\u5316/\u4f9d\u8d56\u7ba1\u7406/monorepo/e0189ac820aefcacbde63dfb11654d49",isDocsHomePage:!1,title:"monorepo",description:"monorepo",source:"@site/../docs/\u5de5\u7a0b\u5316/\u4f9d\u8d56\u7ba1\u7406/monorepo/monorepo.md",slug:"/\u5de5\u7a0b\u5316/\u4f9d\u8d56\u7ba1\u7406/monorepo/e0189ac820aefcacbde63dfb11654d49",permalink:"/blog/docs/\u5de5\u7a0b\u5316/\u4f9d\u8d56\u7ba1\u7406/monorepo/e0189ac820aefcacbde63dfb11654d49",editUrl:"https://github.com/mengshang918/blog/edit/master/website/../docs/\u5de5\u7a0b\u5316/\u4f9d\u8d56\u7ba1\u7406/monorepo/monorepo.md",version:"current",sidebar:"sidebar",previous:{title:"TODO",permalink:"/blog/docs/\u5de5\u7a0b\u5316/\u4f9d\u8d56\u7ba1\u7406/9527a2875c4f497a3e5591c998dbf1b9"},next:{title:"5WHY",permalink:"/blog/docs/\u5de5\u7a0b\u5316/\u4f9d\u8d56\u7ba1\u7406/npm/15732057d56b45df172c9f42dce5b927"}},l=[{value:"Lerna",id:"lerna",children:[{value:"\u5e38\u7528 lerna \u547d\u4ee4",id:"\u5e38\u7528-lerna-\u547d\u4ee4",children:[]}]},{value:"Yarn workspace",id:"yarn-workspace",children:[{value:"\u5e38\u7528\u547d\u4ee4",id:"\u5e38\u7528\u547d\u4ee4",children:[]}]},{value:"lerna \u914d\u5408 yarn workspace",id:"lerna-\u914d\u5408-yarn-workspace",children:[]},{value:"\u6269\u5c55",id:"\u6269\u5c55",children:[]},{value:"\u5e38\u89c1\u95ee\u9898",id:"\u5e38\u89c1\u95ee\u9898",children:[]}],i={rightToc:l};function m(e){var a=e.components,t=Object(r.a)(e,["components"]);return Object(b.b)("wrapper",Object(n.a)({},i,t,{components:a,mdxType:"MDXLayout"}),Object(b.b)("h1",{id:"monorepo"},"monorepo"),Object(b.b)("ol",null,Object(b.b)("li",{parentName:"ol"},Object(b.b)("p",{parentName:"li"},"\u4ec0\u4e48\u662f monorepo \u548c multirepo"),Object(b.b)("ul",{parentName:"li"},Object(b.b)("li",{parentName:"ul"},Object(b.b)("a",Object(n.a)({parentName:"li"},{href:"https://www.perforce.com/blog/vcs/what-monorepo"}),"What Is a Monorepo?")))),Object(b.b)("li",{parentName:"ol"},Object(b.b)("p",{parentName:"li"},"monorepo \u6709\u5565\u4f18\u7f3a\u70b9"),Object(b.b)("ul",{parentName:"li"},Object(b.b)("li",{parentName:"ul"},Object(b.b)("a",Object(n.a)({parentName:"li"},{href:"https://medium.com/@hoangbkit/why-monorepo-in-2018-89221acd4bfb"}),"Why startups need to use monorepo in 2019?")),Object(b.b)("li",{parentName:"ul"},Object(b.b)("a",Object(n.a)({parentName:"li"},{href:"https://danluu.com/monorepo/"}),"Advantages of monorepos")),Object(b.b)("li",{parentName:"ul"},Object(b.b)("a",Object(n.a)({parentName:"li"},{href:"https://github.com/korfuri/awesome-monorepo"}),"Awesome Monorepo")),Object(b.b)("li",{parentName:"ul"},Object(b.b)("a",Object(n.a)({parentName:"li"},{href:"https://www.atlassian.com/git/tutorials/monorepos"}),"Monorepos in Git")),Object(b.b)("li",{parentName:"ul"},Object(b.b)("a",Object(n.a)({parentName:"li"},{href:"https://zhuanlan.zhihu.com/p/31289463"}),"REPO \u98ce\u683c\u4e4b\u4e89\uff1aMONO VS MULTI")),Object(b.b)("li",{parentName:"ul"},Object(b.b)("a",Object(n.a)({parentName:"li"},{href:"https://github.com/babel/babel/blob/master/doc/design/monorepo.md"}),"Why is Babel a monorepo?")))),Object(b.b)("li",{parentName:"ol"},Object(b.b)("p",{parentName:"li"},"\u57fa\u4e8e lerna \u5b9e\u8df5 monorepo"),Object(b.b)("ul",{parentName:"li"},Object(b.b)("li",{parentName:"ul"},Object(b.b)("a",Object(n.a)({parentName:"li"},{href:"https://cloud.tencent.com/developer/article/1467217"}),"NodeJS\uff1aLerna \u2014\u2014 Monorepo \u7684\u6700\u4f73\u5b9e\u8df5")),Object(b.b)("li",{parentName:"ul"},Object(b.b)("a",Object(n.a)({parentName:"li"},{href:"https://github.com/pigcan/blog/issues/3"}),"monorepo \u65b0\u6d6a\u6f6e | introduce lerna")))),Object(b.b)("li",{parentName:"ol"},Object(b.b)("p",{parentName:"li"},"\u6784\u5efa"),Object(b.b)("ul",{parentName:"li"},Object(b.b)("li",{parentName:"ul"},"bazel"),Object(b.b)("li",{parentName:"ul"},"Rollup react"),Object(b.b)("li",{parentName:"ul"},"Gulp babel"),Object(b.b)("li",{parentName:"ul"},"MakeFile")))),Object(b.b)("h2",{id:"lerna"},Object(b.b)("a",Object(n.a)({parentName:"h2"},{href:"https://github.com/lerna"}),"Lerna")),Object(b.b)("blockquote",null,Object(b.b)("p",{parentName:"blockquote"},"Lerna is a tool that optimizes the workflow around managing multi-package repositories with git and npm.")),Object(b.b)("h3",{id:"\u5e38\u7528-lerna-\u547d\u4ee4"},"\u5e38\u7528 lerna \u547d\u4ee4"),Object(b.b)("p",null,"\u53ea\u4ecb\u7ecd\u4e00\u4e9b\u5e38\u7528\u547d\u4ee4\u3002\u8be6\u7ec6\u547d\u4ee4\u8bf7\u67e5\u770b lerna \u7684 readme \u6587\u6863"),Object(b.b)("ol",null,Object(b.b)("li",{parentName:"ol"},Object(b.b)("p",{parentName:"li"},"lerna init"),Object(b.b)("p",{parentName:"li"},"\u521d\u59cb\u5316 monorepo \u9879\u76ee\uff0c\u4f1a\u65b0\u5efa",Object(b.b)("inlineCode",{parentName:"p"},"lerna.json")),Object(b.b)("pre",{parentName:"li"},Object(b.b)("code",Object(n.a)({parentName:"pre"},{}),'//\u9ed8\u8ba4\u662f\u56fa\u5b9a\u6a21\u5f0f\u3002\n{\n    "packages":["packages/*"],\n    "version":"0.0.0"\n}\n')),Object(b.b)("p",{parentName:"li"},"\u6ce8\u610f\uff1a\u5982\u679c\u60f3\u8981\u4f7f\u7528\u72ec\u7acb\u6a21\u5f0f\u3002",Object(b.b)("inlineCode",{parentName:"p"},"lerna init --independent"),"\u3002\u5219\u751f\u6210\u7684",Object(b.b)("inlineCode",{parentName:"p"},"lerna.json"),"\u4e2d\u7684",Object(b.b)("inlineCode",{parentName:"p"},"version"),"\u5b57\u6bb5\u4e3a",Object(b.b)("inlineCode",{parentName:"p"},"independent"),"\u800c\u4e0d\u662f",Object(b.b)("inlineCode",{parentName:"p"},"0.0.0")),Object(b.b)("ul",{parentName:"li"},Object(b.b)("li",{parentName:"ul"},Object(b.b)("p",{parentName:"li"},Object(b.b)("a",Object(n.a)({parentName:"p"},{href:"https://github.com/lerna/lerna#fixedlocked-mode-default"}),"\u56fa\u5b9a\u6a21\u5f0f\u548c\u72ec\u7acb\u6a21\u5f0f\u533a\u522b")),Object(b.b)("ul",{parentName:"li"},Object(b.b)("li",{parentName:"ul"},Object(b.b)("p",{parentName:"li"},"lerna version"),Object(b.b)("p",{parentName:"li"},"\u56fa\u5b9a\u6a21\u5f0f\u3002\u4f1a\u66f4\u65b0\u6839\u76ee\u5f55 changelog\uff0c\u5e76\u4e14 publishconfig")),Object(b.b)("li",{parentName:"ul"},Object(b.b)("p",{parentName:"li"},"\u72ec\u7acb\u6a21\u5f0f"),Object(b.b)("p",{parentName:"li"},"\u53ea\u6709\u5f53\u524d packge \u6539\u53d8 changelog \u624d\u4f1a\u6539\u53d8\u3002\u4e0d\u4f1a\u5f71\u54cd\u5176\u4ed6 package")))))),Object(b.b)("li",{parentName:"ol"},Object(b.b)("p",{parentName:"li"},Object(b.b)("a",Object(n.a)({parentName:"p"},{href:"https://github.com/lerna/lerna/tree/master/commands/version#lernaversion"}),"lerna version")),Object(b.b)("p",{parentName:"li"},"\u53d1\u5e03\u5de5\u4f5c\u533a\u4e2d\u81ea\u4e0a\u6b21\u53d1\u5e03\u6709\u66f4\u6539\u7684 package\u3002\u5305\u7684\u7248\u672c\u53ef\u4ee5\u81ea\u5b9a\u4e49\uff0c\u4e5f\u53ef\u4ee5\u6839\u636e\u4e00\u4e9b\u6761\u4ef6\u81ea\u52a8\u751f\u6210\u3002\u8fd9\u91cc\u6211\u53ea\u4ecb\u7ecd\u6839\u636e commit \u63d0\u4ea4\u4fe1\u606f\u81ea\u52a8\u751f\u6210 package \u7248\u672c\uff0c\u5176\u5b83\u53ef\u4ee5\u70b9\u51fb\u94fe\u63a5\u67e5\u770b\u8be6\u60c5"),Object(b.b)("ul",{parentName:"li"},Object(b.b)("li",{parentName:"ul"},Object(b.b)("p",{parentName:"li"},Object(b.b)("inlineCode",{parentName:"p"},"lerna version --conventional-commits")),Object(b.b)("p",{parentName:"li"},"\u6309\u7167",Object(b.b)("a",Object(n.a)({parentName:"p"},{href:"https://www.conventionalcommits.org/en/v1.0.0/"}),"\u5e38\u89c4\u63d0\u4ea4\u89c4\u8303"),"\u81ea\u52a8\u751f\u6210 package version\u3002"),Object(b.b)("p",{parentName:"li"},Object(b.b)("inlineCode",{parentName:"p"},"fix"),"\u7c7b\u578b\u63d0\u4ea4\u8f6c\u6362\u4e3a",Object(b.b)("inlineCode",{parentName:"p"},"PATCH"),"\u53d1\u884c\u7248\u3002",Object(b.b)("inlineCode",{parentName:"p"},"feat"),"\u7c7b\u578b\u63d0\u4ea4\u8f6c\u6362\u4e3a",Object(b.b)("inlineCode",{parentName:"p"},"MINOR"),"\u53d1\u884c\u7248\u3002",Object(b.b)("inlineCode",{parentName:"p"},"BREAKING CHANGE"),"\u65e0\u8bba\u7c7b\u578b\u5982\u4f55\uff0c\u63d0\u4ea4\u4e2d\u7684\u63d0\u4ea4\u90fd\u5e94\u8f6c\u6362\u4e3a",Object(b.b)("inlineCode",{parentName:"p"},"MAJOR"),"\u53d1\u884c\u7248\u3002"),Object(b.b)("p",{parentName:"li"},Object(b.b)("strong",{parentName:"p"},"\u63d0\u793a\uff1a\u4e0d\u7ba1\u662f\u72ec\u7acb\u8fd8\u662f\u56fa\u5b9a\u6a21\u5f0f\uff0c\u67d0\u4e2a\u5305\u53d8\u5316\u3002\u5176\u5b83 package \u4f9d\u8d56\u8be5\u5305\u5728\u53d1\u5e03\u7684\u65f6\u5019\u90fd\u4f1a\u66f4\u65b0 version\u3002\u53ea\u662f\u4e24\u4e2a\u6a21\u5f0f\u4e0d\u540c\u7684\u662f major \u7684\u53d8\u5316\u662f\u5426\u7edf\u4e00")),Object(b.b)("p",{parentName:"li"},Object(b.b)("strong",{parentName:"p"},"\u6ce8\u610f\uff1a"),"\u5728 commir \u7684 footer \u4e2d\u4ee5",Object(b.b)("inlineCode",{parentName:"p"},"BREAKING CHANGE:"),"\u5f00\u5934\u5c31\u662f\u91cd\u5927\u66f4\u65b0"),Object(b.b)("p",{parentName:"li"},"\u4e00\u822c package \u7684\u683c\u5f0f\u662f major.minor.patch \u7ec4\u6210\u3002\u4f8b\u5b50\uff1a1.0.0"),Object(b.b)("ul",{parentName:"li"},Object(b.b)("li",{parentName:"ul"},Object(b.b)("p",{parentName:"li"},"\u9ed8\u8ba4\u6a21\u5f0f\uff1a\u56fa\u5b9a\u6a21\u5f0f\u4e0b Fixed/Locked mode (default)"),Object(b.b)("ul",{parentName:"li"},Object(b.b)("li",{parentName:"ul"},"\u67d0\u4e2a package \u6709\u91cd\u5927\u66f4\u65b0\uff0c\u5de5\u4f5c\u533a\u6240\u6709 package \u90fd\u4f1a\u589e\u52a0\u4e00\u4e2a major \u7248\u672c"),Object(b.b)("li",{parentName:"ul"},"\u6839\u76ee\u5f55 changelog \u4f1a\u6539\u53d8"),Object(b.b)("li",{parentName:"ul"},"lerna.json \u4e2d version \u7684 messge \u7684",Object(b.b)("inlineCode",{parentName:"li"},"S%"),"\u7248\u672c\u4f1a\u968f\u7740 version \u53d8\u5316\u3002"))),Object(b.b)("li",{parentName:"ul"},Object(b.b)("p",{parentName:"li"},"\u72ec\u7acb\u6a21\u5f0f"),Object(b.b)("ul",{parentName:"li"},Object(b.b)("li",{parentName:"ul"},Object(b.b)("p",{parentName:"li"},"\u6839\u76ee\u5f55 changelog \u4e0d\u4f1a\u6539\u53d8")),Object(b.b)("li",{parentName:"ul"},Object(b.b)("p",{parentName:"li"},"lerna.json \u4e2d version \u7684 messge \u7684",Object(b.b)("inlineCode",{parentName:"p"},"S%"),"\u7248\u672c\u4e0d\u4f1a\u7531 version \u4ee3\u66ff\u3002\u4efb\u7136\u662f",Object(b.b)("inlineCode",{parentName:"p"},"s%"),"\u3002\uff08\u53c2\u8003\uff1a",Object(b.b)("a",Object(n.a)({parentName:"p"},{href:"https://github.com/lerna/lerna/tree/master/commands/version#--message-msg"}),"lerna version -m"),"\uff09"),Object(b.b)("p",{parentName:"li"},"\u5efa\u8bae\u72ec\u7acb\u6a21\u5f0f\u4f7f\u7528",Object(b.b)("inlineCode",{parentName:"p"},'lerna version --conventional-commits -m "chore(release): publish \u7248\u672c\u53f7"')))))))),Object(b.b)("pre",{parentName:"li"},Object(b.b)("code",Object(n.a)({parentName:"pre"},{className:"language-json"}),'//lerna.json\n{\n  "command": {\n    "version": {\n      //lerna version\u53ea\u80fd\u5728master\u5206\u652f\u4e2d\u4f7f\u7528\n      "allowBranch": ["master"],\n      //\u540clerna version -m "chore(release): publish %s"\u3002\u9ed8\u8ba4lerna version\u751f\u6210\u7684commit\u662f\u6ca1\u6709\u9075\u5faaconventional commit\u89c4\u8303\u7684\u3002\u4f7f\u7528\u8fd9\u4e2a\u53ef\u4ee5\u6307\u5b9a\u53d1\u5e03\u7684commitmsg\n      "message": "chore(release): publish %s",\n      //\u68c0\u6d4b\u66f4\u6539\u7684\u8f6f\u4ef6\u5305\u65f6\uff0c\u5ffd\u7565\u4e0eglob\u5339\u914d\u7684\u6587\u4ef6\u4e2d\u7684\u66f4\u6539\n      "ignoreChanges": [\n        "*.md",\n        "*.txt"\n        //\u4e00\u4e9b\u6d4b\u8bd5\u6587\u4ef6\u3001\u548c\u53d1\u5e03\u65e0\u5173\u7684\u6587\u4ef6\u3002\u3002\u3002\n      ]\n    }\n  }\n}\n'))),Object(b.b)("li",{parentName:"ol"},Object(b.b)("p",{parentName:"li"},Object(b.b)("a",Object(n.a)({parentName:"p"},{href:"https://github.com/lerna/lerna/tree/master/commands/bootstrap#readme"}),"lerna bootstrap")),Object(b.b)("p",{parentName:"li"},"\u914d\u5408 yarn workspace \u4e4b\u540e\uff0c\u4e00\u822c\u4f7f\u7528",Object(b.b)("inlineCode",{parentName:"p"},"yarn install"),"\u4ee3\u66ff",Object(b.b)("inlineCode",{parentName:"p"},"lerna bootstrap")),Object(b.b)("pre",{parentName:"li"},Object(b.b)("code",Object(n.a)({parentName:"pre"},{className:"language-json"}),'// lerna.json\n{\n    "npmClient":"yarn",\n    "useWorkspaces":true\n}\n//\u6839\u76ee\u5f55 package.json\n{\n    "workspaces": [\n    "packages/*"\n  ],\n}\n'))),Object(b.b)("li",{parentName:"ol"},Object(b.b)("p",{parentName:"li"},Object(b.b)("a",Object(n.a)({parentName:"p"},{href:"https://github.com/lerna/lerna/tree/master/commands/exec#readme"}),"lerna exec")),Object(b.b)("p",{parentName:"li"},"\u5728\u5de5\u4f5c\u533a\u4e2d\u8fd0\u884c\u4efb\u610f\u547d\u4ee4\uff0c\u4f7f\u7528",Object(b.b)("inlineCode",{parentName:"p"},"--"),"\u4f20\u9012\u53c2\u6570")),Object(b.b)("li",{parentName:"ol"},Object(b.b)("p",{parentName:"li"},Object(b.b)("a",Object(n.a)({parentName:"p"},{href:"https://github.com/lerna/lerna/tree/master/commands/run#readme"}),"lerna run")),Object(b.b)("p",{parentName:"li"},"\u8fd0\u884c\u5de5\u4f5c\u533a\u4e2d\u67d0\u4e2a script \u811a\u672c\uff08\u53ea\u9488\u5bf9\u5177\u6709\u8fd9\u4e2a script \u811a\u672c\u7684\u5305\u6267\u884c\uff09\uff0c\u4f7f\u7528",Object(b.b)("inlineCode",{parentName:"p"},"--"),"\u4f20\u9012\u53c2\u6570")),Object(b.b)("li",{parentName:"ol"},Object(b.b)("p",{parentName:"li"},Object(b.b)("a",Object(n.a)({parentName:"p"},{href:"https://github.com/lerna/lerna/tree/master/commands/import#readme"}),"lerna import")),Object(b.b)("p",{parentName:"li"},Object(b.b)("inlineCode",{parentName:"p"},"lerna import path --preserve-commit")),Object(b.b)("p",{parentName:"li"},"\u5c06\u5f53\u524d\u5df2\u6709\u7684\u5e93\u6dfb\u52a0\u5230\u5de5\u4f5c\u533a\u91cc\u9762\u3002\u4f1a\u4fdd\u7559 commit \u4fe1\u606f(\u5305\u62ec\u539f\u59cb\u63d0\u4ea4\u4eba\u548c\u4f5c\u8005)\u3002\u4e0d\u4f7f\u7528",Object(b.b)("inlineCode",{parentName:"p"},"--preserve-commit"),"\u5219\u4f1a\u5bfc\u81f4\u63d0\u4ea4\u4eba\u66f4\u6539\u4e3a\u5f53\u524d import \u7684\u4eba\u3002")),Object(b.b)("li",{parentName:"ol"},Object(b.b)("p",{parentName:"li"},Object(b.b)("a",Object(n.a)({parentName:"p"},{href:"https://github.com/lerna/lerna/tree/master/commands/publish#readme"}),"lerna publish")),Object(b.b)("p",{parentName:"li"},Object(b.b)("a",Object(n.a)({parentName:"p"},{href:"https://choosealicense.com/"}),"\u9009\u62e9\u4e00\u4e2a\u5f00\u6e90\u8bb8\u53ef\u8bc1")),Object(b.b)("p",{parentName:"li"},"\u5982\u679c\u662f scope package\uff08@xxx/some-package\uff09,\u5219\u9700\u8981\u5728",Object(b.b)("inlineCode",{parentName:"p"},"package"),"\u7684",Object(b.b)("inlineCode",{parentName:"p"},"package.json"),"\u6307\u5b9a",Object(b.b)("inlineCode",{parentName:"p"},"publishConfig.access"),"\u5b57\u6bb5"),Object(b.b)("pre",{parentName:"li"},Object(b.b)("code",Object(n.a)({parentName:"pre"},{className:"language-json"}),'//package\u7684package.json\u6587\u4ef6\n{\n  "publishConfig": {\n    //\u6307\u5b9a\u8303\u56f4\u5305\u7684\u8bbf\u95ee\u6743\u9650 \u4e0d\u8bbe\u7f6epublic\uff0c\u5c31\u4ed8\u94b1\u5347\u7ea7npm\u8d26\u53f7\u5427\u3002\n    "access": "public",\n    //\u6307\u5b9a\u53d1\u5e03\u7684\u76ee\u5f55 \u53ef\u4ee5\u914d\u5408.npmignore\n    "directory": ""\n  }\n}\n')),Object(b.b)("p",{parentName:"li"},"\u9700\u63d0\u524d",Object(b.b)("inlineCode",{parentName:"p"},"npm login"),",\u4f7f\u7528",Object(b.b)("inlineCode",{parentName:"p"},"npm whoami"),"\u5224\u65ad\u662f\u5426\u767b\u5f55\u6210\u529f\u3002\u6ca1\u95ee\u9898\u4f7f\u7528",Object(b.b)("inlineCode",{parentName:"p"},"lerna publish from-package"),"\u53d1\u5e03\u5305"))),Object(b.b)("h2",{id:"yarn-workspace"},"Yarn workspace"),Object(b.b)("p",null,Object(b.b)("inlineCode",{parentName:"p"},"yarn config list"),"\u4e2d\u6ca1\u6709\u8bbe\u7f6e workspaces-experimental \u5219\u4f7f\u7528\u4ee5\u4e0b\u547d\u4ee4\u5f00\u542f"),Object(b.b)("p",null,Object(b.b)("inlineCode",{parentName:"p"},"yarn config set workspaces-experimental true")),Object(b.b)("p",null,"\u4f7f\u7528 yarn workspace \u4e3b\u8981\u662f\u53ef\u4ee5\u5c06\u5404\u4e2a package \u76f8\u540c\u7684\u5305\u63d0\u5347\u5230\u6839\u76ee\u5f55\u4e2d\u3002\u907f\u514d\u6bcf\u4e2a package \u90fd install \u4e00\u4e2a\u5305\u3002"),Object(b.b)("p",null,"\u4f7f\u7528\u5de5\u4f5c\u533a\u4e4b\u540e\uff0cpackage \u6ca1\u6709\u81ea\u5df1\u7684 yarn.lock \u6587\u4ef6\u3002\u6240\u6709 packages \u5171\u7528\u6839\u76ee\u5f55\u7684 yarn.lock \u6587\u4ef6"),Object(b.b)("ol",null,Object(b.b)("li",{parentName:"ol"},Object(b.b)("a",Object(n.a)({parentName:"li"},{href:"https://classic.yarnpkg.com/blog/2017/08/02/introducing-workspaces/"}),"Workspaces in Yarn")),Object(b.b)("li",{parentName:"ol"},Object(b.b)("a",Object(n.a)({parentName:"li"},{href:"https://classic.yarnpkg.com/en/docs/workspaces"}),"WorkSpaces")),Object(b.b)("li",{parentName:"ol"},Object(b.b)("a",Object(n.a)({parentName:"li"},{href:"https://classic.yarnpkg.com/blog/2018/02/15/nohoist/"}),"nohoist in Workspaces"))),Object(b.b)("h3",{id:"\u5e38\u7528\u547d\u4ee4"},"\u5e38\u7528\u547d\u4ee4"),Object(b.b)("p",null,"\u5f53\u7b2c\u4e00\u6b21\u5b89\u88c5 package \u63d0\u793a\u627e\u4e0d\u5230 package\u3002\u53ef\u4ee5\u8bd5\u7740\u5199\u6b7b\u7248\u672c"),Object(b.b)("ol",null,Object(b.b)("li",{parentName:"ol"},Object(b.b)("p",{parentName:"li"},"\u5de5\u4f5c\u533a"),Object(b.b)("ol",{parentName:"li"},Object(b.b)("li",{parentName:"ol"},Object(b.b)("p",{parentName:"li"},"\u7ed9\u67d0\u4e2a package \u6dfb\u52a0\u5305"),Object(b.b)("ul",{parentName:"li"},Object(b.b)("li",{parentName:"ul"},Object(b.b)("p",{parentName:"li"},"\u5c06 ",Object(b.b)("inlineCode",{parentName:"p"},"react")," \u548c ",Object(b.b)("inlineCode",{parentName:"p"},"react-dom")," \u4f5c\u4e3a ",Object(b.b)("inlineCode",{parentName:"p"},"devDependencies")," \u52a0\u5230 ",Object(b.b)("inlineCode",{parentName:"p"},"packages/awesome-package/package.json")," \u4e2d"),Object(b.b)("p",{parentName:"li"},Object(b.b)("inlineCode",{parentName:"p"},"yarn workspace awesome-package add react react-dom --dev")))),Object(b.b)("p",{parentName:"li"},"\u6ce8\u610f\uff1a\u7b2c\u4e00\u6b21(some-package \u8fd8\u672a\u53d1\u5e03\u5230 npm \u4e0a)\u4f7f\u7528 lerna add some-package --scope=packaget")),Object(b.b)("li",{parentName:"ol"},Object(b.b)("p",{parentName:"li"},"\u5220\u9664\u67d0\u4e2a package \u7684\u67d0\u4e2a\u5305"),Object(b.b)("ul",{parentName:"li"},Object(b.b)("li",{parentName:"ul"},Object(b.b)("p",{parentName:"li"},"\u4ece ",Object(b.b)("inlineCode",{parentName:"p"},"packages/web-project/package.json")," \u4e2d\u79fb\u9664 ",Object(b.b)("inlineCode",{parentName:"p"},"some-package")),Object(b.b)("p",{parentName:"li"},Object(b.b)("inlineCode",{parentName:"p"},"yarn workspace web-project remove some-package --save"))))),Object(b.b)("li",{parentName:"ol"},Object(b.b)("p",{parentName:"li"},"\u7ed9\u6240\u6709 package \u6dfb\u52a0\u67d0\u4e2a\u5305"),Object(b.b)("p",{parentName:"li"},Object(b.b)("del",{parentName:"p"},Object(b.b)("inlineCode",{parentName:"del"},"yarn workspace add some-package"))),Object(b.b)("p",{parentName:"li"},"\u4f7f\u7528",Object(b.b)("inlineCode",{parentName:"p"},"lerna add package"),"\uff0c\u4e00\u6b21\u53ea\u80fd\u6dfb\u52a0\u4e00\u4e2a"))),Object(b.b)("p",{parentName:"li"},Object(b.b)("del",{parentName:"p"},"4. \u7ed9\u6240\u6709 package \u5220\u9664\u67d0\u4e2a\u5305")),Object(b.b)("p",{parentName:"li"},Object(b.b)("del",{parentName:"p"},Object(b.b)("inlineCode",{parentName:"del"},"yarn workspace remove some-package")))),Object(b.b)("li",{parentName:"ol"},Object(b.b)("p",{parentName:"li"},"\u6839\u76ee\u5f55"),Object(b.b)("ol",{parentName:"li"},Object(b.b)("li",{parentName:"ol"},Object(b.b)("p",{parentName:"li"},"\u6839\u76ee\u5f55\u6dfb\u52a0\u5305"),Object(b.b)("p",{parentName:"li"},Object(b.b)("inlineCode",{parentName:"p"},"yarn add -W some-packeages"))),Object(b.b)("li",{parentName:"ol"},Object(b.b)("p",{parentName:"li"},"\u6839\u76ee\u5f55\u5220\u9664\u5305"),Object(b.b)("p",{parentName:"li"},Object(b.b)("inlineCode",{parentName:"p"},"yarn remove -S some-package")))))),Object(b.b)("h2",{id:"lerna-\u914d\u5408-yarn-workspace"},"lerna \u914d\u5408 yarn workspace"),Object(b.b)("ol",null,Object(b.b)("li",{parentName:"ol"},Object(b.b)("a",Object(n.a)({parentName:"li"},{href:"https://zhuanlan.zhihu.com/p/71385053"}),"\u57fa\u4e8e lerna \u548c yarn workspace \u7684 monorepo \u5de5\u4f5c\u6d41"))),Object(b.b)("h2",{id:"\u6269\u5c55"},"\u6269\u5c55"),Object(b.b)("ul",null,Object(b.b)("li",{parentName:"ul"},Object(b.b)("a",Object(n.a)({parentName:"li"},{href:"https://trunkbaseddevelopment.com/"}),"\u57fa\u4e8e\u4e3b\u5e72\u548c\u57fa\u4e8e\u4e2d\u7ee7\u7684\u5f00\u53d1")),Object(b.b)("li",{parentName:"ul"},Object(b.b)("a",Object(n.a)({parentName:"li"},{href:"https://www.atlassian.com/git/tutorials/git-submodule"}),"git submodule"))),Object(b.b)("h2",{id:"\u5e38\u89c1\u95ee\u9898"},"\u5e38\u89c1\u95ee\u9898"),Object(b.b)("ol",null,Object(b.b)("li",{parentName:"ol"},Object(b.b)("p",{parentName:"li"},"\u53d1\u5e03\u6d4b\u8bd5\u5305 command"),Object(b.b)("ul",{parentName:"li"},Object(b.b)("li",{parentName:"ul"},Object(b.b)("p",{parentName:"li"},Object(b.b)("inlineCode",{parentName:"p"},'lerna version --conventional-prerelease --conventional-commits --no-changelog -m "chore(release): \u53d1\u5e03\u6d4b\u8bd5\u7248\u672c"'))),Object(b.b)("li",{parentName:"ul"},Object(b.b)("p",{parentName:"li"},"a",Object(b.b)("inlineCode",{parentName:"p"},"lerna publish from-package"))))),Object(b.b)("li",{parentName:"ol"},Object(b.b)("p",{parentName:"li"},"\u4e3a\u4ec0\u4e48 lerna.json \u8bbe\u7f6e\u4e86",Object(b.b)("inlineCode",{parentName:"p"},"command.version.message"),"\u4e3a",Object(b.b)("inlineCode",{parentName:"p"},"chore(release): %s"),"\u65e0\u6548"),Object(b.b)("p",{parentName:"li"},"\u53ea\u6709\u5728\u56fa\u5b9a\u6a21\u5f0f\u624d\u4f1a\u66ff\u6362%s")),Object(b.b)("li",{parentName:"ol"},Object(b.b)("p",{parentName:"li"},"\u5982\u4f55\u81ea\u5b9a\u4e49 changelog"),Object(b.b)("p",{parentName:"li"},"\u53c2\u8003\uff1a",Object(b.b)("a",{href:Object(p.a)("docs/\u5de5\u7a0b\u5316/\u534f\u8bae\u89c4\u8303/11d34bb17b6b6518fe13a517e8018b61#\u5728-monorepo-\u4e2d\u5982\u4f55\u751f\u6210-changelog")},"\u5728 monorepo \u4e2d\u5982\u4f55\u751f\u6210 changelog")))))}m.isMDXComponent=!0}}]);