<!-- START doctoc generated TOC please keep comment here to allow auto update -->
<!-- DON'T EDIT THIS SECTION, INSTEAD RE-RUN doctoc TO UPDATE -->

- [why gatsby](#why-gatsby)
  - [hexo、jelkyll、gatsby 对比](#hexojelkyllgatsby-%E5%AF%B9%E6%AF%94)
- [start gatsby](#start-gatsby)
- [plugins](#plugins)
  - [获取数据](#%E8%8E%B7%E5%8F%96%E6%95%B0%E6%8D%AE)
  - [文档头](#%E6%96%87%E6%A1%A3%E5%A4%B4)
  - [图像优化](#%E5%9B%BE%E5%83%8F%E4%BC%98%E5%8C%96)
  - [指定目录中的 react 组件自动创建页面](#%E6%8C%87%E5%AE%9A%E7%9B%AE%E5%BD%95%E4%B8%AD%E7%9A%84-react-%E7%BB%84%E4%BB%B6%E8%87%AA%E5%8A%A8%E5%88%9B%E5%BB%BA%E9%A1%B5%E9%9D%A2)
  - [支持 typescript 和 tsx](#%E6%94%AF%E6%8C%81-typescript-%E5%92%8C-tsx)
- [test](#test)
- [搭建](#%E6%90%AD%E5%BB%BA)
- [部署](#%E9%83%A8%E7%BD%B2)
- [参考](#%E5%8F%82%E8%80%83)

<!-- END doctoc generated TOC please keep comment here to allow auto update -->

## why gatsby

### hexo、jelkyll、gatsby 对比

## start gatsby

```shell
npm install -g gatsby-cli
```

1. `src/pages`下的 js 文件会自动转换成页面，生成路由

2. `src/components`下新建一些`Layout`、公共组件

3. 样式

   1. 全局样式

      1. src/styles 下新建全局 css 文件。

         reset.css 或 global.css

      2. `gatsby-browser.js` import 或 require`reset.css`

   2. sass、stylus、css in js

      1. 安装相应插件

4. 全局变量

   1. `gatsby-config.js`中新建字段，graphql 查询

5. 数据查询

   1. 页面查询，直接使用 graphql

   2. 非页面组件，使用 useStaticQuery 查询

   3. gatsby-source-filesystem 获取文件节点

   4. Transformer-plugins 转换数据源 md、json...

      1. 转换 md

         [gatsby-transformer-remark](https://www.gatsbyjs.com/plugins/gatsby-transformer-remark/?=)

         配合[frontmatter](https://jekyllrb.com/docs/front-matter/)实现 md 的额外变量信息。例如标题、tags、发布日期等

      2. 待优化
         1. 目录 toc 和摘录
         2. 页数 上下页
         3. 上下篇
         4. tags
         5. 目录锚点跳转

6. pwa 离线支持

   1. gatsby-plugin-manifest
   2. Gatsby-plugin-offline

7. seo

   1. Gatsby-plugin-react-helmet
   2. React-helmer

## plugins

### 获取数据

gatsby-source-filesystem

> The plugin creates `File` nodes from files. The various “transformer” plugins can transform `File` nodes into various other types of data e.g. `gatsby-transformer-json` transforms JSON files into JSON data nodes and `gatsby-transformer-remark` transforms markdown files into `MarkdownRemark` nodes from which you can query an HTML representation of the markdown
>
> 翻译：
>
> 该插件从文件创建 File 节点。各种“ transformer”插件可以将 File 节点转换为各种其他类型的数据，例如 gatsby-transformer-json 将 JSON 文件转换为 JSON 数据节点，而 gatsby-transformer-remark 将 markdown 文件转换为 MarkdownRemark 节点，您可以从中查询 markdown 的 HTML 表示形式

### 文档头

gatsby-plugin-react-helmet

> Manage document head data with react-helmet. Provides drop-in server rendering support for Gatsby.
>
> 翻译：使用 react-helmet 管理文档头数据。为 Gatsby 提供嵌入式服务器渲染支持

### 图像优化

> gatsby-image 配合 gatsby-plugin-sharp、gatsby-source-filesystem、gatsby-transformer-sharp

1. gatsby-plugin-sharp

   > 公开了一些基于[Sharp 图像处理库的](https://github.com/lovell/sharp)图像处理功能 。这是其他 Gatsby 插件通常使用的低级帮助程序插件。通常，您不应该直接使用它，但是如果进行非常自定义的图像处理，可能会发现它很有用。

2. [gatsby-transformer-sharp](https://image-processing.gatsbyjs.org/)

   > [`gatsby-transformer-sharp`](https://www.gatsbyjs.org/packages/gatsby-transformer-sharp/) 公开了一些基于[Sharp 图像处理库的](https://github.com/lovell/sharp)图像处理 GraphQL 函数。借助它和[Gatsby Image，](https://www.gatsbyjs.org/packages/gatsby-image/)您可以轻松地将快速，优化，响应迅速的图像添加到您的站点

3. gatsby-image
   1. [medium 博客](https://medium.com/@kyle.robert.gill/ridiculously-easy-image-optimization-with-gatsby-js-59d48e15db6e)
   2. [egghead.io 视屏](https://egghead.io/playlists/using-gatsby-image-with-gatsby-ea85129e)

### 指定目录中的 react 组件自动创建页面

Gatsby-plugin-page-creator

> Gatsby plugin that automatically creates pages from React components in specified directories. Gatsby includes this plugin automatically in all sites for creating pages from components in `src/pages`

### 支持 typescript 和 tsx

gatsby-plugin-typescript

## test

1. surge

2. 样式

   - 全局
     1. src/styles global.css
     2. gatsby-browser.js import './src/styles/global.css'
   - 局部
     1. 新建 xx.module.css
     2. import xx from 'xx.module.css'

3. 插件、布局

4. 数据

   1. [graphql](https://www.howtographql.com/)

      只有页面可以进行页面查询。非页面组件（例如 Layout）可以使用 StaticQuery

   2. http://localhost:8000/___graphql

## 搭建

1. 先使用 md 搭建
2. 试一下 headless cms 搭建
3. 集成 ci cd 看看

## 部署

1. [github pages](https://docs.github.com/en/github/working-with-github-pages)
2. surge
3. Netlify
4. ci cd

## 参考

1. [官网]()
2. 中文网
3. [github：react 文档官网](https://github.com/reactjs/reactjs.org/blob/master/package.json)
